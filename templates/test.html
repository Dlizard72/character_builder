<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Roll a Die</title>
  </head>
  <body>
    <h1>Character Sheet</h1>
    <form method="POST">
      <label for="selected_character">Load Character:</label>
      <select name="selected_character">
        {% for char_name in saved_characters.keys() %}
        <option value="{{ char_name }}">{{ char_name }}</option>
        {% endfor %}
      </select>
      <button type="submit" name="action" value="load">Load</button>
    </form>
    <form method="POST">
      {% if not editing %}
      <p>Name: {{ name }}</p>
      <input type="hidden" name="name" value="{{ name }}" />

      <p>Race: {{ race }}</p>
      <input type="hidden" name="race" value="{{ race }}" />

      <p>Class: {{ Class }}</p>
      <input type="hidden" name="Class" value="{{ Class }}" />

      <p>Background: {{ background }}</p>
      <input type="hidden" name="background" value="{{ background }}" />

      {% if stats %} {% if editing_stats %}
      <label
        >Str: <input type="number" name="Str" value="{{ stats.Str }}" /></label
      ><br />
      <label
        >Int: <input type="number" name="Int" value="{{ stats.Int }}" /></label
      ><br />
      <label
        >Wis: <input type="number" name="Wis" value="{{ stats.Wis }}" /></label
      ><br />
      <label
        >Dex: <input type="number" name="Dex" value="{{ stats.Dex }}" /></label
      ><br />
      <label
        >Con: <input type="number" name="Con" value="{{ stats.Con }}" /></label
      ><br />
      <label
        >Cha: <input type="number" name="Cha" value="{{ stats.Cha }}" /></label
      ><br />
      <button type="submit" name="action" value="save">Save</button>
      {% else %}
      <!-- show hidden inputs if not editing -->
      <input type="hidden" name="Str" value="{{ stats.Str }}" />
      <input type="hidden" name="Int" value="{{ stats.Int }}" />
      <input type="hidden" name="Wis" value="{{ stats.Wis }}" />
      <input type="hidden" name="Dex" value="{{ stats.Dex }}" />
      <input type="hidden" name="Con" value="{{ stats.Con }}" />
      <input type="hidden" name="Cha" value="{{ stats.Cha }}" />
      {% endif %} {% endif %}

      <button type="submit" name="action" value="edit">Edit</button>
      <button type="submit" name="action" value="save_character">
        Save Character
      </button>

      {% else %}
      <!-- Editable fields when editing -->
      <label>Name: <input type="text" name="name" value="{{ name }}" /></label
      ><br />
      <label>Race: <input type="text" name="race" value="{{ race }}" /></label
      ><br />
      <label
        >Class: <input type="text" name="Class" value="{{ Class }}" /></label
      ><br />
      <label
        >Background:
        <input type="text" name="background" value="{{ background }}" /></label
      ><br />

      {% if stats %}
      <!-- Preserve stat values even while editing text fields -->
      <input type="hidden" name="Str" value="{{ stats.Str }}" />
      <input type="hidden" name="Int" value="{{ stats.Int }}" />
      <input type="hidden" name="Wis" value="{{ stats.Wis }}" />
      <input type="hidden" name="Dex" value="{{ stats.Dex }}" />
      <input type="hidden" name="Con" value="{{ stats.Con }}" />
      <input type="hidden" name="Cha" value="{{ stats.Cha }}" />
      {% endif %}

      <!-- âœ… Save button goes here -->
      <button type="submit" name="action" value="save">Save</button>
      {% endif %}
    </form>

    <h2>Attributes</h2>
    <form method="POST">
      <button type="submit" name="action" value="roll">Roll</button>
    </form>
    {% if stats %}
    <table>
      <tr>
        <td>Str Score: {{ stats.Str }}</td>
        <td>Int Score: {{ stats.Int }}</td>
        <td>Wis Score: {{ stats.Wis }}</td>
        <td>Dex Score: {{ stats.Dex }}</td>
        <td>Con Score: {{ stats.Con }}</td>
        <td>Cha Score: {{ stats.Cha }}</td>
      </tr>
    </table>
    <form method="POST">
      <!-- Hidden fields to preserve stats -->
      <input type="hidden" name="Str" value="{{ stats.Str }}" />
      <input type="hidden" name="Int" value="{{ stats.Int }}" />
      <input type="hidden" name="Wis" value="{{ stats.Wis }}" />
      <input type="hidden" name="Dex" value="{{ stats.Dex }}" />
      <input type="hidden" name="Con" value="{{ stats.Con }}" />
      <input type="hidden" name="Cha" value="{{ stats.Cha }}" />

      <!-- You can also preserve name/race/etc. if needed -->
      <input type="hidden" name="name" value="{{ name }}" />
      <input type="hidden" name="race" value="{{ race }}" />
      <input type="hidden" name="Class" value="{{ Class }}" />
      <input type="hidden" name="background" value="{{ background }}" />

      <button type="submit" name="action" value="change">Change Stats</button>
    </form>
    {% endif %}
  </body>
</html>
